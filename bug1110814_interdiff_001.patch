# HG changeset patch
# Parent d1c65fb7595d1809a7c266e18fc8b0049c7225f6
# User Ben Kelly <ben@wanderview.com>
Bug 1110814 interdiff 001 Re-enable unified builds, fix try failures

diff --git a/dom/cache/CachePushStreamChild.cpp b/dom/cache/CachePushStreamChild.cpp
--- a/dom/cache/CachePushStreamChild.cpp
+++ b/dom/cache/CachePushStreamChild.cpp
@@ -15,17 +15,17 @@
 namespace mozilla {
 namespace dom {
 namespace cache {
 
 class CachePushStreamChild::Callback MOZ_FINAL : public nsIInputStreamCallback
                                                , public nsICancelableRunnable
 {
 public:
-  Callback(CachePushStreamChild* aActor)
+  explicit Callback(CachePushStreamChild* aActor)
     : mActor(aActor)
     , mOwningThread(NS_GetCurrentThread())
   {
     MOZ_ASSERT(mActor);
   }
 
   NS_METHOD
   OnInputStreamReady(nsIAsyncInputStream* aStream)
diff --git a/dom/cache/moz.build b/dom/cache/moz.build
--- a/dom/cache/moz.build
+++ b/dom/cache/moz.build
@@ -33,18 +33,17 @@ EXPORTS.mozilla.dom.cache += [
     'ReadStream.h',
     'SavedTypes.h',
     'StreamList.h',
     'StreamUtils.h',
     'Types.h',
     'TypeUtils.h',
 ]
 
-#UNIFIED_SOURCES += [
-SOURCES += [
+UNIFIED_SOURCES += [
     'Action.cpp',
     'ActorChild.cpp',
     'AutoUtils.cpp',
     'Cache.cpp',
     'CacheChild.cpp',
     'CacheParent.cpp',
     'CachePushStreamChild.cpp',
     'CachePushStreamParent.cpp',
diff --git a/dom/cache/test/mochitest/test_cache_put.js b/dom/cache/test/mochitest/test_cache_put.js
--- a/dom/cache/test/mochitest/test_cache_put.js
+++ b/dom/cache/test/mochitest/test_cache_put.js
@@ -1,13 +1,13 @@
-var url = 'test_cache_match.js';
+var url = 'test_cache.js';
 var cache;
 var fetchResponse;
 Promise.all([fetch(url),
-             caches.open('putter')]).then(function(results) {
+             caches.open('putter' + context)]).then(function(results) {
   fetchResponse = results[0];
   cache = results[1];
   return cache.put(url, fetchResponse.clone());
 }).then(function(result) {
   is(undefined, result, 'Successful put() should resolve undefined');
   return cache.match(url);
 }).then(function(response) {
   ok(response, 'match() should find resppnse that was previously put()');

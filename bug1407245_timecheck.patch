# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  8e7df74b85de3870f1b53c1f8224109f5641e36f
Bug 1407245 Fix service worker update 24-hour time check conversion from microseconds. r=asuth

diff --git a/dom/workers/ServiceWorkerRegistrationInfo.cpp b/dom/workers/ServiceWorkerRegistrationInfo.cpp
--- a/dom/workers/ServiceWorkerRegistrationInfo.cpp
+++ b/dom/workers/ServiceWorkerRegistrationInfo.cpp
@@ -348,17 +348,17 @@ ServiceWorkerRegistrationInfo::IsLastUpd
   const int64_t kSecondsPerDay = 86400;
   const int64_t now =
     mCreationTime + static_cast<PRTime>((TimeStamp::Now() -
                                          mCreationTimeStamp).ToMicroseconds());
 
   // now < mLastUpdateTime if the system time is reset between storing
   // and loading mLastUpdateTime from ServiceWorkerRegistrar.
   if (now < mLastUpdateTime ||
-      (now - mLastUpdateTime) / PR_MSEC_PER_SEC > kSecondsPerDay) {
+      (now - mLastUpdateTime) / PR_USEC_PER_SEC > kSecondsPerDay) {
     return true;
   }
   return false;
 }
 
 void
 ServiceWorkerRegistrationInfo::AsyncUpdateRegistrationStateProperties(WhichServiceWorker aWorker,
                                                                       TransitionType aTransition)

# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  37a361d3d4e9c0f5f1bd4cf1e8db21d364f50b69
Bug 1311324 P3 Remove ServiceWorkerMessageEvent interface. r=bz

diff --git a/dom/events/test/test_all_synthetic_events.html b/dom/events/test/test_all_synthetic_events.html
--- a/dom/events/test/test_all_synthetic_events.html
+++ b/dom/events/test/test_all_synthetic_events.html
@@ -325,23 +325,16 @@ const kEventConstructors = {
                                                          var e = document.createEvent("scrollareaevent");
                                                          e.initScrollAreaEvent(aName, aProps.bubbles, aProps.cancelable,
                                                                                aProps.view, aProps.details,
                                                                                aProps.x || 0.0, aProps.y || 0.0,
                                                                                aProps.width || 0.0, aProps.height || 0.0);
                                                          return e;
                                                        },
                                              },
-  ServiceWorkerMessageEvent:                 { create: function (aName, aProps) {
-                                                         var e = new ServiceWorkerMessageEvent("serviceworkermessageevent", { bubbles: aProps.bubbles,
-                                                             cancelable: aProps.cancelable, data: aProps.data, origin: aProps.origin,
-                                                             lastEventId: aProps.lastEventId, source: aProps.source });
-                                                         return e;
-                                                       },
-                                             },
   SimpleGestureEvent:                        { create: function (aName, aProps) {
                                                          var e = document.createEvent("simplegestureevent");
                                                          e.initSimpleGestureEvent(aName, aProps.bubbles, aProps.cancelable,
                                                                                   aProps.view, aProps.detail,
                                                                                   aProps.screenX, aProps.screenY,
                                                                                   aProps.clientX, aProps.clientY,
                                                                                   aProps.ctrlKey, aProps.altKey, aProps.shiftKey, aProps.metaKey,
                                                                                   aProps.button, aProps.relatedTarget,
diff --git a/dom/tests/mochitest/general/test_interfaces.js b/dom/tests/mochitest/general/test_interfaces.js
--- a/dom/tests/mochitest/general/test_interfaces.js
+++ b/dom/tests/mochitest/general/test_interfaces.js
@@ -830,18 +830,16 @@ var interfaceNamesInGlobalScope =
     "ScrollAreaEvent",
 // IMPORTANT: Do not change this list without review from a DOM peer!
     "Selection",
 // IMPORTANT: Do not change this list without review from a DOM peer!
     "ServiceWorker",
 // IMPORTANT: Do not change this list without review from a DOM peer!
     "ServiceWorkerContainer",
 // IMPORTANT: Do not change this list without review from a DOM peer!
-    "ServiceWorkerMessageEvent",
-// IMPORTANT: Do not change this list without review from a DOM peer!
     "ServiceWorkerRegistration",
 // IMPORTANT: Do not change this list without review from a DOM peer!
     {name: "ScopedCredential", disabled: true},
 // IMPORTANT: Do not change this list without review from a DOM peer!
     {name: "ScopedCredentialInfo", disabled: true},
 // IMPORTANT: Do not change this list without review from a DOM peer!
     "ShadowRoot", // Bogus, but the test harness forces it on.  See bug 1159768.
 // IMPORTANT: Do not change this list without review from a DOM peer!
diff --git a/dom/webidl/ServiceWorkerMessageEvent.webidl b/dom/webidl/ServiceWorkerMessageEvent.webidl
deleted file mode 100644
--- a/dom/webidl/ServiceWorkerMessageEvent.webidl
+++ /dev/null
@@ -1,48 +0,0 @@
-/* -*- Mode: IDL; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this file,
- * You can obtain one at http://mozilla.org/MPL/2.0/.
- *
- * The origin of this IDL file is
- * http://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html
- *
- */
-
-[Pref="dom.serviceWorkers.enabled",
- Constructor(DOMString type, optional ServiceWorkerMessageEventInit eventInitDict),
- Exposed=Window]
-interface ServiceWorkerMessageEvent : Event {
-  /**
-   * Custom data associated with this event.
-   */
-  readonly attribute any data;
-
-  /**
-   * The origin of the site from which this event originated.
-   */
-  readonly attribute DOMString origin;
-
-  /**
-   * The last event ID string of the event source.
-   */
-  readonly attribute DOMString lastEventId;
-
-  /**
-   * The service worker or port which originated this event.
-   * FIXME: Use SameOject after IDL spec is updated
-   * https://bugzilla.mozilla.org/show_bug.cgi?id=1196097
-   */
-  [Constant] readonly attribute (ServiceWorker or MessagePort)? source;
-
-  [Constant, Cached, Frozen]
-  readonly attribute sequence<MessagePort> ports;
-};
-
-dictionary ServiceWorkerMessageEventInit : EventInit
-{
-  any data = null;
-  DOMString origin = "";
-  DOMString lastEventId = "";
-  (ServiceWorker or MessagePort)? source = null;
-  sequence<MessagePort> ports = [];
-};
diff --git a/dom/webidl/moz.build b/dom/webidl/moz.build
--- a/dom/webidl/moz.build
+++ b/dom/webidl/moz.build
@@ -1082,17 +1082,16 @@ GENERATED_EVENTS_WEBIDL_FILES = [
     'PluginCrashedEvent.webidl',
     'PopStateEvent.webidl',
     'PopupBlockedEvent.webidl',
     'PresentationConnectionAvailableEvent.webidl',
     'PresentationConnectionCloseEvent.webidl',
     'ProgressEvent.webidl',
     'RecordErrorEvent.webidl',
     'ScrollViewChangeEvent.webidl',
-    'ServiceWorkerMessageEvent.webidl',
     'StyleRuleChangeEvent.webidl',
     'StyleSheetApplicableStateChangeEvent.webidl',
     'StyleSheetChangeEvent.webidl',
     'TCPServerSocketEvent.webidl',
     'TCPSocketErrorEvent.webidl',
     'TCPSocketEvent.webidl',
     'TrackEvent.webidl',
     'UDPMessageEvent.webidl',

# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  dcf22168d033c2229152d96453d24040843f01a9
Bug 1287440 P2 Update test to expect .indexedDB to be null when storage is not available. r=khuey

diff --git a/dom/tests/mochitest/general/storagePermissionsUtils.js b/dom/tests/mochitest/general/storagePermissionsUtils.js
--- a/dom/tests/mochitest/general/storagePermissionsUtils.js
+++ b/dom/tests/mochitest/general/storagePermissionsUtils.js
@@ -171,22 +171,17 @@ function storagePrevented() {
     try {
       sessionStorage.getItem("X");
       ok(false, "getting sessionStorage should have thrown");
     } catch (e) {
       ok(true, "getting sessionStorage threw");
     }
   }
 
-  try {
-    indexedDB;
-    ok(false, "getting indexedDB should have thrown");
-  } catch (e) {
-    ok(true, "getting indexedDB threw");
-  }
+  ok(indexedDB === null, "getting indexedDB should return null");
 
   try {
     var promise = caches.keys();
     ok(true, "getting caches didn't throw");
 
     return new Promise((resolve, reject) => {
       promise.then(function() {
         ok(false, "The promise should have rejected");

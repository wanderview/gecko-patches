# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  d38d06f85ef59c5dbb5d4a1a8d895957a78714de
Bug 1316837 P2 MOZ_DIAGNOSTIC_ASSERT counters in Resume()/Thaw(). r=smaug

diff --git a/dom/base/nsGlobalWindow.cpp b/dom/base/nsGlobalWindow.cpp
--- a/dom/base/nsGlobalWindow.cpp
+++ b/dom/base/nsGlobalWindow.cpp
@@ -11892,17 +11892,17 @@ nsGlobalWindow::Resume()
 {
   MOZ_ASSERT(NS_IsMainThread());
   MOZ_ASSERT(IsInnerWindow());
 
   // Resume all children.  This restores timers recursively canceled
   // in Suspend() and ensures all children have the correct mSuspendDepth.
   CallOnChildren(&nsGlobalWindow::Resume);
 
-  MOZ_ASSERT(mSuspendDepth != 0);
+  MOZ_DIAGNOSTIC_ASSERT(mSuspendDepth != 0);
   mSuspendDepth -= 1;
   if (mSuspendDepth != 0) {
     return;
   }
 
   // We should not be able to resume a frozen window.  It must be Thaw()'d first.
   MOZ_ASSERT(mFreezeDepth == 0);
 
@@ -12041,17 +12041,17 @@ nsGlobalWindow::Thaw()
 void
 nsGlobalWindow::ThawInternal()
 {
   MOZ_ASSERT(NS_IsMainThread());
   MOZ_ASSERT(IsSuspended());
 
   CallOnChildren(&nsGlobalWindow::ThawInternal);
 
-  MOZ_ASSERT(mFreezeDepth != 0);
+  MOZ_DIAGNOSTIC_ASSERT(mFreezeDepth != 0);
   mFreezeDepth -= 1;
   MOZ_ASSERT(mSuspendDepth >= mFreezeDepth);
   if (mFreezeDepth != 0) {
     return;
   }
 
   TimeStamp now = TimeStamp::Now();
   DebugOnly<bool> _seenDummyTimeout = false;

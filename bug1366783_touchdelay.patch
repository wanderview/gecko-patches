# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  599fcb4695fed647d76ac52bf27790c6a73118e9
Bug 1366783 Loosen responsive design mode test check for 300ms touch delay. r=jryans

diff --git a/devtools/client/responsive.html/test/browser/touch.html b/devtools/client/responsive.html/test/browser/touch.html
--- a/devtools/client/responsive.html/test/browser/touch.html
+++ b/devtools/client/responsive.html/test/browser/touch.html
@@ -66,17 +66,20 @@
   div.addEventListener("mouseleave", function (evt) {
     div.style.backgroundColor = "blue";
     updatePreviousEvent(evt);
   }, true);
 
   div.addEventListener("mousedown", function (evt) {
     if (previousEvent === "touchend" && touchendTime !== 0) {
       let now = performance.now();
-      div.dataset.isDelay = ((now - touchendTime) >= 300);
+      // Do to time spent processing events our measurement might
+      // be fractionally short of the actual delay.  Round up any
+      // microsecond changes in case we get something like 299.9.
+      div.dataset.isDelay = ((now - touchendTime) >= 299.5);
     } else {
       div.dataset.isDelay = false;
     }
     updatePreviousEvent(evt);
   }, true);
 
   div.addEventListener("mousemove", updatePreviousEvent, true);
 
diff --git a/devtools/client/responsivedesign/test/touch.html b/devtools/client/responsivedesign/test/touch.html
--- a/devtools/client/responsivedesign/test/touch.html
+++ b/devtools/client/responsivedesign/test/touch.html
@@ -65,17 +65,20 @@
   div.addEventListener("mouseleave", function(evt) {
     div.style.backgroundColor = "blue";
     updatePreviousEvent(evt);
   }, true);
 
   div.addEventListener("mousedown", function(evt){
     if (previousEvent === "touchend" && touchendTime !== 0) {
       let now = performance.now();
-      div.dataset.isDelay = ((now - touchendTime) >= 300) ? true : false;
+      // Do to time spent processing events our measurement might
+      // be fractionally short of the actual delay.  Round up any
+      // microsecond changes in case we get something like 299.9.
+      div.dataset.isDelay = ((now - touchendTime) >= 299.5) ? true : false;
     } else {
       div.dataset.isDelay = false;
     }
     updatePreviousEvent(evt);
   }, true);
 
   div.addEventListener("mousemove", updatePreviousEvent, true);
 

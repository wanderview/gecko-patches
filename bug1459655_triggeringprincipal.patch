# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  b52b2eb81d1e52d259d55d948281c7f6ddf1270c
Bug 1459655 Check for error when serializing the LoadInfo triggering principal. r=baku

diff --git a/ipc/glue/BackgroundUtils.cpp b/ipc/glue/BackgroundUtils.cpp
--- a/ipc/glue/BackgroundUtils.cpp
+++ b/ipc/glue/BackgroundUtils.cpp
@@ -310,16 +310,17 @@ LoadInfoToLoadInfoArgs(nsILoadInfo *aLoa
                                   &loadingPrincipalInfoTemp);
     NS_ENSURE_SUCCESS(rv, rv);
     loadingPrincipalInfo = loadingPrincipalInfoTemp;
   }
 
   PrincipalInfo triggeringPrincipalInfo;
   rv = PrincipalToPrincipalInfo(aLoadInfo->TriggeringPrincipal(),
                                 &triggeringPrincipalInfo);
+  NS_ENSURE_SUCCESS(rv, rv);
 
   OptionalPrincipalInfo principalToInheritInfo = mozilla::void_t();
   if (aLoadInfo->PrincipalToInherit()) {
     PrincipalInfo principalToInheritInfoTemp;
     rv = PrincipalToPrincipalInfo(aLoadInfo->PrincipalToInherit(),
                                   &principalToInheritInfoTemp);
     NS_ENSURE_SUCCESS(rv, rv);
     principalToInheritInfo = principalToInheritInfoTemp;

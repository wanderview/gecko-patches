# HG changeset patch
# Parent 7da31b4939f21860da3ee0bf4130a6fcbbec1c6b
# User Ben Kelly <ben@wanderview.com>
Rebase Cache for Fetch Clone() landing.


diff --git a/dom/cache/FetchPut.cpp b/dom/cache/FetchPut.cpp
--- a/dom/cache/FetchPut.cpp
+++ b/dom/cache/FetchPut.cpp
@@ -209,17 +209,17 @@ FetchPut::DoFetchOnMainThread()
   for (uint32_t i = 0; i < mStateList.Length(); ++i) {
     nsRefPtr<InternalRequest> internalRequest =
       ToInternalRequest(mStateList[i].mPCacheRequest);
 
     // If there is a stream we must clone it so that its still available
     // to store in the cache later;
     if (mStateList[i].mRequestStream) {
       internalRequest->SetBody(mStateList[i].mRequestStream);
-      nsRefPtr<InternalRequest> clone = new InternalRequest(*internalRequest);
+      nsRefPtr<InternalRequest> clone = internalRequest->Clone();
 
       // The copy construction clone above can change the source stream,
       // so get it back out to use when we put this in the cache.
       internalRequest->GetBody(getter_AddRefs(mStateList[i].mRequestStream));
 
       internalRequest = clone;
     }
 

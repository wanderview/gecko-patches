# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  b89f3d5036bd3166d40e1d1e3d35ef3dc1dc1809

diff --git a/netwerk/protocol/http/InterceptedChannel.cpp b/netwerk/protocol/http/InterceptedChannel.cpp
--- a/netwerk/protocol/http/InterceptedChannel.cpp
+++ b/netwerk/protocol/http/InterceptedChannel.cpp
@@ -461,27 +461,27 @@ InterceptedChannelChrome::StartSynthesiz
     NS_ENSURE_SUCCESS(rv, rv);
 
     mSynthesizedCacheEntry = nullptr;
 
     if (!mChannel->AwaitingCacheCallbacks()) {
       rv = mChannel->ContinueConnect();
       NS_ENSURE_SUCCESS(rv, rv);
     }
+  }
 
-    if (!aBody) {
-      if (aBodyCompletionCallback) {
-        aBodyCompletionCallback->Run();
-      }
-    } else {
-      nsresult rv = StreamCopyStart(mResponseBody, aBody,
-                                    aBodyCompletionCallback,
-                                    aBodyFailedCallback);
-      NS_ENSURE_SUCCESS(rv, rv);
+  if (!aBody) {
+    if (aBodyCompletionCallback) {
+      aBodyCompletionCallback->Run();
     }
+  } else {
+    nsresult rv = StreamCopyStart(mResponseBody, aBody,
+                                  aBodyCompletionCallback,
+                                  aBodyFailedCallback);
+    NS_ENSURE_SUCCESS(rv, rv);
   }
 
   return NS_OK;
 }
 
 NS_IMETHODIMP
 InterceptedChannelChrome::FinishSynthesizedResponse()
 {
@@ -651,28 +651,28 @@ InterceptedChannelContent::StartSynthesi
   originalURI->Equals(responseURI, &equal);
   if (!equal) {
     mChannel->ForceIntercepted(mSynthesizedInput);
     mChannel->BeginNonIPCRedirect(responseURI, *mSynthesizedResponseHead.ptr());
   } else {
     mChannel->OverrideWithSynthesizedResponse(mSynthesizedResponseHead.ref(),
                                               mSynthesizedInput,
                                               mStreamListener);
+  }
 
-    if (!aBody) {
-      if (aBodyCompletionCallback) {
-        aBodyCompletionCallback->Run();
-      }
-    } else {
-      NS_ENSURE_TRUE(mResponseBody, NS_ERROR_FAILURE);
-      nsresult rv = StreamCopyStart(mResponseBody, aBody,
-                                    aBodyCompletionCallback,
-                                    aBodyFailedCallback);
-      NS_ENSURE_SUCCESS(rv, rv);
+  if (!aBody) {
+    if (aBodyCompletionCallback) {
+      aBodyCompletionCallback->Run();
     }
+  } else {
+    NS_ENSURE_TRUE(mResponseBody, NS_ERROR_FAILURE);
+    nsresult rv = StreamCopyStart(mResponseBody, aBody,
+                                  aBodyCompletionCallback,
+                                  aBodyFailedCallback);
+    NS_ENSURE_SUCCESS(rv, rv);
   }
 
   return NS_OK;
 }
 
 NS_IMETHODIMP
 InterceptedChannelContent::FinishSynthesizedResponse()
 {

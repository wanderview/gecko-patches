# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  57f9e4c605a0a684a2616fbafd0ac321bba4a0cb
Bug 1256428 P14 Remove dead code in SeviceWorkerUpdateJob.cpp. r=ehsan

diff --git a/dom/workers/ServiceWorkerUpdateJob.cpp b/dom/workers/ServiceWorkerUpdateJob.cpp
--- a/dom/workers/ServiceWorkerUpdateJob.cpp
+++ b/dom/workers/ServiceWorkerUpdateJob.cpp
@@ -317,31 +317,16 @@ ServiceWorkerUpdateJob2::ComparisonResul
   }
 
   if (!StringBeginsWith(mRegistration->mScope, maxPrefix)) {
     NS_WARNING("By default a service worker's scope is restricted to at or below it's script's location.");
     FailUpdateJob(NS_ERROR_DOM_SECURITY_ERR);
     return;
   }
 
-  nsAutoCString scopeKey;
-
-  RefPtr<ServiceWorkerManager> swm = ServiceWorkerManager::GetInstance();
-  rv = swm->PrincipalToScopeKey(mRegistration->mPrincipal, scopeKey);
-  if (NS_WARN_IF(NS_FAILED(rv))) {
-    FailUpdateJob(NS_ERROR_FAILURE);
-    return;
-  }
-
-  ServiceWorkerManager::RegistrationDataPerPrincipal* data;
-  if (!swm->mRegistrationInfos.Get(scopeKey, &data)) {
-    FailUpdateJob(NS_ERROR_FAILURE);
-    return;
-  }
-
   MOZ_ASSERT(!mServiceWorker);
   mServiceWorker = new ServiceWorkerInfo(mRegistration->mPrincipal,
                                          mRegistration->mScope,
                                          mScriptSpec, aNewCacheName);
 
   nsMainThreadPtrHandle<ServiceWorkerUpdateJob2> handle(
       new nsMainThreadPtrHolder<ServiceWorkerUpdateJob2>(this));
   RefPtr<LifeCycleEventCallback> callback = new ContinueUpdateRunnable(handle);

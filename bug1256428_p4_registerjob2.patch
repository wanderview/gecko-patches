# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  bbf4e4f21bda9eb7ef1d78391885a5dc1f4bc7a6
Bug 1256428 P4 Add ServiceWorkerRegisterJob2. r=ehsan

diff --git a/dom/workers/ServiceWorkerRegisterJob.cpp b/dom/workers/ServiceWorkerRegisterJob.cpp
new file mode 100644
--- /dev/null
+++ b/dom/workers/ServiceWorkerRegisterJob.cpp
@@ -0,0 +1,42 @@
+/* -*- Mode: C++; tab-width: 8; indent-tabs-mode: nil; c-basic-offset: 2 -*- */
+/* vim: set ts=8 sts=2 et sw=2 tw=80: */
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+#include "ServiceWorkerRegisterJob.h"
+
+namespace mozilla {
+namespace dom {
+namespace workers {
+
+ServiceWorkerRegisterJob2::~ServiceWorkerRegisterJob2()
+{
+  // TODO
+}
+
+void
+ServiceWorkerRegisterJob2::AsyncExecute()
+{
+  // TODO
+}
+
+ServiceWorkerRegisterJob2::ServiceWorkerRegisterJob2(nsIPrincipal* aPrincipal,
+                                                     const nsACString& aScope,
+                                                     const nsACString& aScriptSpec)
+  : ServiceWorkerInstallJob2(ServiceWorkerJob2::Type::Register,
+                             aPrincipal, aScope, aScriptSpec)
+{
+  // TODO
+}
+
+already_AddRefed<ServiceWorkerRegistrationInfo>
+ServiceWorkerRegisterJob2::GetResultRegistration()
+{
+  // TODO
+  return nullptr;
+}
+
+} // namespace workers
+} // namespace dom
+} // namespace mozilla
diff --git a/dom/workers/ServiceWorkerRegisterJob.h b/dom/workers/ServiceWorkerRegisterJob.h
new file mode 100644
--- /dev/null
+++ b/dom/workers/ServiceWorkerRegisterJob.h
@@ -0,0 +1,39 @@
+/* -*- Mode: C++; tab-width: 8; indent-tabs-mode: nil; c-basic-offset: 2 -*- */
+/* vim: set ts=8 sts=2 et sw=2 tw=80: */
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+#ifndef mozilla_dom_workers_serviceworkerregisterjob_h
+#define mozilla_dom_workers_serviceworkerregisterjob_h
+
+#include "ServiceWorkerInstallJob.h"
+
+namespace mozilla {
+namespace dom {
+namespace workers {
+
+class ServiceWorkerRegisterJob2 final : public ServiceWorkerInstallJob2
+{
+  ~ServiceWorkerRegisterJob2();
+
+protected:
+  virtual void
+  AsyncExecute() override;
+
+public:
+  ServiceWorkerRegisterJob2(nsIPrincipal* aPrincipal,
+                            const nsACString& aScope,
+                            const nsACString& aScriptSpec);
+
+  already_AddRefed<ServiceWorkerRegistrationInfo>
+  GetResultRegistration();
+
+  NS_INLINE_DECL_REFCOUNTING(ServiceWorkerRegisterJob2)
+};
+
+} // namespace workers
+} // namespace dom
+} // namespace mozilla
+
+#endif // mozilla_dom_workers_serviceworkerregisterjob_h
diff --git a/dom/workers/moz.build b/dom/workers/moz.build
--- a/dom/workers/moz.build
+++ b/dom/workers/moz.build
@@ -70,16 +70,17 @@ UNIFIED_SOURCES += [
     'ServiceWorkerJob.cpp',
     'ServiceWorkerJobQueue.cpp',
     'ServiceWorkerManager.cpp',
     'ServiceWorkerManagerChild.cpp',
     'ServiceWorkerManagerParent.cpp',
     'ServiceWorkerManagerService.cpp',
     'ServiceWorkerMessageEvent.cpp',
     'ServiceWorkerPrivate.cpp',
+    'ServiceWorkerRegisterJob.cpp',
     'ServiceWorkerRegistrar.cpp',
     'ServiceWorkerRegistration.cpp',
     'ServiceWorkerScriptCache.cpp',
     'ServiceWorkerWindowClient.cpp',
     'SharedWorker.cpp',
     'URL.cpp',
     'WorkerDebuggerManager.cpp',
     'WorkerLocation.cpp',

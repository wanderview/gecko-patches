# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  7059f776de5b77bd58995ccdeb679bb071eb77ad

diff --git a/layout/reftests/bugs/703186-1-ref.html b/layout/reftests/bugs/703186-1-ref.html
--- a/layout/reftests/bugs/703186-1-ref.html
+++ b/layout/reftests/bugs/703186-1-ref.html
@@ -1,16 +1,18 @@
 <!DOCTYPE html>
 <html class="reftest-wait">
   <head>
     <script type="text/javascript">
       function init()
       {
+        window.addEventListener("focus", function (e) {
+          setTimeout(finish, 0);
+        }, true);
         document.getElementById("link").focus();
-        setTimeout(finish, 0);
       }
 
       function finish()
       {
         document.documentElement.removeAttribute("class");
       }
     </script>
   </head>
diff --git a/layout/reftests/bugs/703186-1.html b/layout/reftests/bugs/703186-1.html
--- a/layout/reftests/bugs/703186-1.html
+++ b/layout/reftests/bugs/703186-1.html
@@ -1,18 +1,19 @@
 <!DOCTYPE html>
 <html class="reftest-wait">
   <head>
     <script type="text/javascript">
       function init()
       {
-        window.addEventListener("focus", function (e) { e.stopPropagation(); },
-                                true);
+        window.addEventListener("focus", function (e) {
+          e.stopPropagation();
+          setTimeout(finish, 0);
+        }, true);
         document.getElementById("link").focus();
-        setTimeout(finish, 0);
       }
 
       function finish()
       {
         document.documentElement.removeAttribute("class");
       }
     </script>
   </head>
diff --git a/layout/reftests/bugs/703186-2-ref.html b/layout/reftests/bugs/703186-2-ref.html
--- a/layout/reftests/bugs/703186-2-ref.html
+++ b/layout/reftests/bugs/703186-2-ref.html
@@ -1,22 +1,26 @@
 <!DOCTYPE html>
 <html class="reftest-wait">
   <head>
     <script type="text/javascript">
       function init()
       {
+        window.addEventListener("focus", function (e) {
+          setTimeout(doTest, 0);
+        }, true);
         document.getElementById("link").focus();
-        setTimeout(doTest, 0);
       }
 
       function doTest()
       {
+        window.addEventListener("blur", function (e) {
+          setTimeout(finish, 0);
+        }, true);
         document.getElementById("link").blur();
-        setTimeout(finish, 0);
       }
 
       function finish()
       {
         document.documentElement.removeAttribute("class");
       }
     </script>
   </head>
diff --git a/layout/reftests/bugs/703186-2.html b/layout/reftests/bugs/703186-2.html
--- a/layout/reftests/bugs/703186-2.html
+++ b/layout/reftests/bugs/703186-2.html
@@ -1,24 +1,27 @@
 <!DOCTYPE html>
 <html class="reftest-wait">
   <head>
     <script type="text/javascript">
       function init()
       {
-        window.addEventListener("blur", function (e) { e.stopPropagation(); },
-                                true);
+        window.addEventListener("focus", function (e) {
+          setTimeout(doTest, 0);
+        }, true);
         document.getElementById("link").focus();
-        setTimeout(doTest, 0);
       }
 
       function doTest()
       {
+        window.addEventListener("blur", function (e) {
+          e.stopPropagation();
+          setTimeout(finish, 0);
+        }, true);
         document.getElementById("link").blur();
-        setTimeout(finish, 0);
       }
 
       function finish()
       {
         document.documentElement.removeAttribute("class");
       }
     </script>
   </head>

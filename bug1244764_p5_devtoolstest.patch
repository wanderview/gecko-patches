# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  0b3dd45872e03ee1ac641e99675c4e0da2f91345
Bug 1244764 P5 Fix devtools test to work with new Cache add()/addAll() behavior. r=ehsan

diff --git a/devtools/client/storage/test/storage-listings.html b/devtools/client/storage/test/storage-listings.html
--- a/devtools/client/storage/test/storage-listings.html
+++ b/devtools/client/storage/test/storage-listings.html
@@ -92,20 +92,25 @@ let idbGenerator = function*() {
 
 function deleteDB(dbName) {
   return new Promise(resolve => {
     dump("removing database " + dbName + " from " + document.location + "\n");
     indexedDB.deleteDatabase(dbName).onsuccess = resolve;
   });
 }
 
+function fetchPut(cache, url) {
+  let response = yield fetch(url);
+  yield cache.put(url, response);
+}
+
 let cacheGenerator = function*() {
   let cache = yield caches.open("plop");
-  yield cache.add("404_cached_file.js");
-  yield cache.add("browser_storage_basic.js");
+  yield fetchPut(cache, "404_cached_file.js");
+  yield fetchPut(cache, "browser_storage_basic.js");
 };
 
 window.setup = function*() {
   yield idbGenerator();
   yield cacheGenerator();
 };
 
 window.clear = function*() {

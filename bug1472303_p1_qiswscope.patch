# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  ace3cf153a8fd9c61e3395db560da68f881bfb4c
Bug 1472303 P1 Make ServiceWorkerGlobalScope QI'able. r=mrbkap

diff --git a/dom/workers/WorkerScope.h b/dom/workers/WorkerScope.h
--- a/dom/workers/WorkerScope.h
+++ b/dom/workers/WorkerScope.h
@@ -297,25 +297,29 @@ public:
   }
 
   void
   Close();
 
   IMPL_EVENT_HANDLER(connect)
 };
 
+#define NS_DOM_SERVICEWORKERGLOBALSCOPE_IID \
+  {0x552bfa7e, 0x0dd5, 0x4e94, {0xa0, 0x43, 0xff, 0x34, 0x6b, 0x6e, 0x04, 0x46}}
+
 class ServiceWorkerGlobalScope final : public WorkerGlobalScope
 {
   const nsString mScope;
   RefPtr<Clients> mClients;
   RefPtr<ServiceWorkerRegistration> mRegistration;
 
   ~ServiceWorkerGlobalScope();
 
 public:
+  NS_DECLARE_STATIC_IID_ACCESSOR(NS_DOM_SERVICEWORKERGLOBALSCOPE_IID)
   NS_DECL_ISUPPORTS_INHERITED
   NS_DECL_CYCLE_COLLECTION_CLASS_INHERITED(ServiceWorkerGlobalScope,
                                            WorkerGlobalScope)
   IMPL_EVENT_HANDLER(notificationclick)
   IMPL_EVENT_HANDLER(notificationclose)
 
   ServiceWorkerGlobalScope(WorkerPrivate* aWorkerPrivate,
                            const ServiceWorkerRegistrationDescriptor& aRegistrationDescriptor);
@@ -354,16 +358,18 @@ public:
 
   // We only need to override the string version of EventListenerAdded, because
   // the atom version should never be called on workers.  Until bug 1450167 is
   // fixed, at least.
   using DOMEventTargetHelper::EventListenerAdded;
   void EventListenerAdded(const nsAString& aType) override;
 };
 
+NS_DEFINE_STATIC_IID_ACCESSOR(ServiceWorkerGlobalScope, NS_DOM_SERVICEWORKERGLOBALSCOPE_IID)
+
 class WorkerDebuggerGlobalScope final : public DOMEventTargetHelper,
                                         public nsIGlobalObject
 {
   WorkerPrivate* mWorkerPrivate;
   RefPtr<Console> mConsole;
   nsCOMPtr<nsISerialEventTarget> mSerialEventTarget;
 
 public:

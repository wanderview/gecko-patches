# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  b4358909520f86d6671812dff92d13bf5abae002
Bug 1378586 P4 Clamp setInterval() based on nesting value instead of always. r=farre

diff --git a/dom/base/TimeoutManager.cpp b/dom/base/TimeoutManager.cpp
--- a/dom/base/TimeoutManager.cpp
+++ b/dom/base/TimeoutManager.cpp
@@ -311,18 +311,17 @@ TimeoutManager::IsInvalidFiringId(uint32
 // uses 5.
 #define DOM_CLAMP_TIMEOUT_NESTING_LEVEL 5u
 
 TimeDuration
 TimeoutManager::CalculateDelay(Timeout* aTimeout) const {
   MOZ_DIAGNOSTIC_ASSERT(aTimeout);
   TimeDuration result = aTimeout->mInterval;
 
-  if (aTimeout->mIsInterval ||
-      aTimeout->mNestingLevel >= DOM_CLAMP_TIMEOUT_NESTING_LEVEL) {
+  if (aTimeout->mNestingLevel >= DOM_CLAMP_TIMEOUT_NESTING_LEVEL) {
     result = TimeDuration::Max(
       result, TimeDuration::FromMilliseconds(gMinClampTimeoutValue));
   }
 
   if (aTimeout->mIsTracking && mThrottleTrackingTimeouts) {
     result = TimeDuration::Max(
       result, TimeDuration::FromMilliseconds(gMinTrackingTimeoutValue));
   }

# HG changeset patch
# Parent f7f178ad46ca3d4e937d6203026502831c9b2667
# User Ben Kelly <ben@wanderview.com>
Fix CrossProcessPipe issues.


diff --git a/ipc/glue/CrossProcessPipe.cpp b/ipc/glue/CrossProcessPipe.cpp
--- a/ipc/glue/CrossProcessPipe.cpp
+++ b/ipc/glue/CrossProcessPipe.cpp
@@ -36,17 +36,17 @@ namespace {
 
 class CrossProcessPipe : public nsICrossProcessPipe
 {
   typedef mozilla::ipc::PipeDirection PipeDirection;
 
   nsCOMPtr<nsIAsyncInputStream> mInputStream;
   nsCOMPtr<nsIAsyncOutputStream> mOutputStream;
 
-  ~CrossProcessPipe() {}
+  virtual ~CrossProcessPipe() {}
 
 public:
   CrossProcessPipe() {}
 
   void
   InitializeStreams(intptr_t aContentParentId, PipeDirection aDirection);
 
   NS_DECL_THREADSAFE_ISUPPORTS
@@ -67,16 +67,19 @@ public:
     : mCrossProcessPipe(aCrossProcessPipe)
   {
   }
 
   NS_DECL_THREADSAFE_ISUPPORTS
   NS_DECL_NSIINPUTSTREAM
   NS_DECL_NSIASYNCINPUTSTREAM
   NS_DECL_NSIIPCSERIALIZABLEINPUTSTREAM
+
+private:
+  virtual ~SerializationPlaceholderStream() { }
 };
 
 NS_IMPL_ISUPPORTS(SerializationPlaceholderStream,
                   nsIAsyncInputStream,
                   nsIInputStream,
                   nsIIPCSerializableInputStream)
 
 NS_IMETHODIMP
diff --git a/ipc/testshell/TestShellTest.cpp b/ipc/testshell/TestShellTest.cpp
--- a/ipc/testshell/TestShellTest.cpp
+++ b/ipc/testshell/TestShellTest.cpp
@@ -27,16 +27,17 @@ public:
 
   Derived*
   AsDerived() const
   {
     return static_cast<Derived*>(const_cast<TestShellTest*>(this));
   }
 
 protected:
+  virtual ~TestShellTest() { }
   bool RecvInputStream(const InputStreamParams& aParams,
 		       const OptionalFileDescriptorSet& aFds);
 };
 
 template <class Derived>
 NS_IMPL_ADDREF(TestShellTest<Derived>)
 
 template <class Derived>

# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  58110e94b328bb911383593a5c82124ea72e3ba4
Bug 1334383 P3 Make WorkerControlEventTarget implement nsILockable. r=froydnj

diff --git a/dom/workers/WorkerPrivate.cpp b/dom/workers/WorkerPrivate.cpp
--- a/dom/workers/WorkerPrivate.cpp
+++ b/dom/workers/WorkerPrivate.cpp
@@ -10,16 +10,17 @@
 #include "nsIClassInfo.h"
 #include "nsIContentSecurityPolicy.h"
 #include "nsIConsoleService.h"
 #include "nsIDOMDOMException.h"
 #include "nsIDOMEvent.h"
 #include "nsIDocument.h"
 #include "nsIDocShell.h"
 #include "nsIInterfaceRequestor.h"
+#include "nsILockable.h"
 #include "nsIMemoryReporter.h"
 #include "nsINetworkInterceptController.h"
 #include "nsIPermissionManager.h"
 #include "nsIScriptError.h"
 #include "nsIScriptGlobalObject.h"
 #include "nsIScriptSecurityManager.h"
 #include "nsIScriptTimeoutHandler.h"
 #include "nsITabChild.h"
@@ -1660,16 +1661,17 @@ public:
   }
 };
 
 } // anonymous namespace
 
 BEGIN_WORKERS_NAMESPACE
 
 class WorkerControlEventTarget final : public nsIEventTarget
+                                     , public nsILockable
 {
   mozilla::Mutex mMutex;
   WorkerPrivate* mWorkerPrivate;
 
   ~WorkerControlEventTarget() = default;
 
 public:
   explicit WorkerControlEventTarget(WorkerPrivate* aWorkerPrivate)
@@ -1730,17 +1732,17 @@ public:
     }
 
     return mWorkerPrivate->IsOnCurrentThread(aIsOnCurrentThread);
   }
 
   NS_DECL_THREADSAFE_ISUPPORTS
 };
 
-NS_IMPL_ISUPPORTS(WorkerControlEventTarget, nsIEventTarget)
+NS_IMPL_ISUPPORTS(WorkerControlEventTarget, nsIEventTarget, nsILockable)
 
 END_WORKERS_NAMESPACE
 
 WorkerLoadInfo::WorkerLoadInfo()
   : mLoadFlags(nsIRequest::LOAD_NORMAL)
   , mWindowID(UINT64_MAX)
   , mServiceWorkerID(0)
   , mReferrerPolicy(net::RP_Unset)

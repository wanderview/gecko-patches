# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  54bd6a41e4201a2c09e1a75cbb2569ec45cf5a0b
Bug 1363829 P14 Make pushPrefEnv() use setTimeout(1) since setTimeout(0) fires slightly faster now. r=ehsan

diff --git a/testing/specialpowers/content/specialpowersAPI.js b/testing/specialpowers/content/specialpowersAPI.js
--- a/testing/specialpowers/content/specialpowersAPI.js
+++ b/testing/specialpowers/content/specialpowersAPI.js
@@ -703,31 +703,31 @@ SpecialPowersAPI.prototype = {
   },
 
   _setTimeout: function(callback) {
     // for mochitest-browser
     if (typeof window != 'undefined')
       setTimeout(callback, 0);
     // for mochitest-plain
     else
-      content.window.setTimeout(callback, 0);
+      content.window.setTimeout(callback, 1);
   },
 
   _delayCallbackTwice: function(callback) {
      function delayedCallback() {
        function delayAgain(aCallback) {
          // Using this._setTimeout doesn't work here
          // It causes failures in mochtests that use
          // multiple pushPrefEnv calls
          // For chrome/browser-chrome mochitests
          if (typeof window != 'undefined')
            setTimeout(aCallback, 0);
          // For mochitest-plain
          else
-           content.window.setTimeout(aCallback, 0);
+           content.window.setTimeout(aCallback, 1);
        }
        delayAgain(delayAgain(callback));
      }
      return delayedCallback;
   },
 
   /* apply permissions to the system and when the test case is finished (SimpleTest.finish())
      we will revert the permission back to the original.

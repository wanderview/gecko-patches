# HG changeset patch
# Parent e653805f8976b6e4de3c1ec2b235d77dfba88989
# User Ben Kelly <ben@wanderview.com>
Bug 1158314 Fix upstream cache-storage-match.https.html to expect NotFoundError


diff --git a/testing/web-platform/tests/service-workers/cache-storage/script-tests/cache-storage-match.js b/testing/web-platform/tests/service-workers/cache-storage/script-tests/cache-storage-match.js
--- a/testing/web-platform/tests/service-workers/cache-storage/script-tests/cache-storage-match.js
+++ b/testing/web-platform/tests/service-workers/cache-storage/script-tests/cache-storage-match.js
@@ -106,18 +106,21 @@ promise_test(function(test) {
 promise_test(function(test) {
     var transaction = create_unique_transaction();
     return self.caches.has('foo')
       .then(function(has_foo) {
           assert_false(has_foo, "The cache should not exist.");
           return self.caches.match(transaction.request, {cacheName: 'foo'});
         })
       .then(function(response) {
-          assert_equals(response, undefined,
-                        'The response should not be found.');
+          assert_unreached('The match with bad cache name should reject.');
+        })
+      .catch(function(err) {
+          assert_equals(err.name, 'NotFoundError',
+                        'The match should reject with NotFoundError.');
           return self.caches.has('foo');
         })
       .then(function(has_foo) {
           assert_false(has_foo, "The cache should still not exist.");
         })
 }, 'CacheStorageMatch with no caches available but name provided');
 
 done();


# HG changeset patch
# User Jan Beich <jbeich@FreeBSD.org>
# Date 1503165942 0
# Node ID d24b19ad4801fe007bd479f8ba128196a563a43c
# Parent  10b109b2b0afdd472f499bd1de37c1428d0ca19f
Bug 1391993 - plugins: Fix -Wunreachable-code-return in PluginInstanceChild.cpp for non-OSX. r?jaas

MozReview-Commit-ID: 9qIndwc8G0N


diff --git a/dom/plugins/ipc/PluginInstanceChild.cpp b/dom/plugins/ipc/PluginInstanceChild.cpp
--- a/dom/plugins/ipc/PluginInstanceChild.cpp
+++ b/dom/plugins/ipc/PluginInstanceChild.cpp
@@ -3178,18 +3178,16 @@
         NS_ERROR("Cannot create optimized surface");
         return false;
     }
 
     if (!MaybeCreatePlatformHelperSurface()) {
         NS_ERROR("Cannot create helper surface");
         return false;
     }
-
-    return true;
 #elif defined(XP_MACOSX)
 
     if (!mDoubleBufferCARenderer.HasCALayer()) {
         void *caLayer = nullptr;
         if (mDrawingModel == NPDrawingModelCoreGraphics) {
             if (!mCGLayer) {
                 caLayer = mozilla::plugins::PluginUtilsOSX::GetCGLayer(CallCGDraw,
                                                                        this,
@@ -3233,16 +3231,17 @@
 
         if (mPluginIface->setwindow)
             (void) mPluginIface->setwindow(&mData, &mWindow);
 
         nsIntRect toInvalidate(0, 0, mWindow.width, mWindow.height);
         mAccumulatedInvalidRect.UnionRect(mAccumulatedInvalidRect, toInvalidate);
     }
 #endif
+
     return true;
 }
 
 void
 PluginInstanceChild::UpdateWindowAttributes(bool aForceSetWindow)
 {
 #if defined(MOZ_X11) || defined(XP_WIN)
     RefPtr<gfxASurface> curSurface = mHelperSurface ? mHelperSurface : mCurrentSurface;


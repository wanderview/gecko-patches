# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  ffac2798999c5b84f1b4605a1280994bb665a406
Bug 1284621 P1 Add a BasePromiseWorker.prototype.terminate() method. r=yoric

diff --git a/toolkit/components/promiseworker/PromiseWorker.jsm b/toolkit/components/promiseworker/PromiseWorker.jsm
--- a/toolkit/components/promiseworker/PromiseWorker.jsm
+++ b/toolkit/components/promiseworker/PromiseWorker.jsm
@@ -357,16 +357,25 @@ this.BasePromiseWorker.prototype = {
       if (typeof options.outExecutionDuration == "number") {
         options.outExecutionDuration += durationMs;
       } else {
         options.outExecutionDuration = durationMs;
       }
       return reply.ok;
 
     }.bind(this));
+  },
+
+  terminate: function() {
+    if (!this.hasOwnProperty("_worker")) {
+      // Worker has not been lazily spawned yet.
+      return;
+    }
+
+    this._worker.terminate();
   }
 };
 
 /**
  * An error that has been serialized by the worker.
  *
  * @constructor
  */

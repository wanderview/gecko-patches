# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  77614b41274d2d2ff7c50a8c0c7cd3aab94fbefc

diff --git a/dom/base/nsGlobalWindow.cpp b/dom/base/nsGlobalWindow.cpp
--- a/dom/base/nsGlobalWindow.cpp
+++ b/dom/base/nsGlobalWindow.cpp
@@ -4859,16 +4859,17 @@ already_AddRefed<nsPIDOMWindowOuter>
 nsGlobalWindow::GetContentInternal(ErrorResult& aError, CallerType aCallerType)
 {
   MOZ_ASSERT(IsOuterWindow());
 
   // First check for a named frame named "content"
   nsCOMPtr<nsPIDOMWindowOuter> domWindow =
     GetChildWindow(NS_LITERAL_STRING("content"));
   if (domWindow) {
+    printf_stderr("### ### nsGlobalWindow::GetContentInternal() child window named content\n");
     return domWindow.forget();
   }
 
   // If we're contained in <iframe mozbrowser>, then GetContent is the same as
   // window.top.
   if (mDocShell && mDocShell->GetIsInMozBrowser()) {
     return GetTopOuter();
   }
@@ -4882,31 +4883,42 @@ nsGlobalWindow::GetContentInternal(Error
     nsCOMPtr<nsIBaseWindow> baseWin(do_QueryInterface(mDocShell));
 
     if (baseWin) {
       bool visible = false;
       baseWin->GetVisibility(&visible);
 
       if (!visible) {
         mDocShell->GetSameTypeRootTreeItem(getter_AddRefs(primaryContent));
+        if (!primaryContent) {
+          printf_stderr("### ### nsGlobalWindow::GetContentInternal() nullptr primaryContent after docshell call\n");
+        } else {
+          printf_stderr("### ### nsGlobalWindow::GetContentInternal() docshell returned primaryContent\n");
+        }
       }
     }
   }
 
   if (!primaryContent) {
     nsCOMPtr<nsIDocShellTreeOwner> treeOwner = GetTreeOwner();
     if (!treeOwner) {
       aError.Throw(NS_ERROR_FAILURE);
       return nullptr;
     }
 
     treeOwner->GetPrimaryContentShell(getter_AddRefs(primaryContent));
+    if (!primaryContent) {
+      printf_stderr("### ### nsGlobalWindow::GetContentInternal() nullptr primaryContent after treeOwner call\n");
+    } else {
+      printf_stderr("### ### nsGlobalWindow::GetContentInternal() treeowner returned primaryContent\n");
+    }
   }
 
   if (!primaryContent) {
+    printf_stderr("### ### nsGlobalWindow::GetContentInternal() returning nullptr primaryContent\n");
     return nullptr;
   }
 
   domWindow = primaryContent->GetWindow();
   return domWindow.forget();
 }
 
 MozSelfSupport*

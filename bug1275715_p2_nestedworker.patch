# HG changeset patch
# User Ben Kelly <ben@wanderview.com>
# Parent  4a50c681cb06f00d744c89e3963273f955cb9b80
Bug 1275715 P2 Hold nested worker alive until outer worker is collected. r=asuth

diff --git a/dom/tests/mochitest/fetch/nested_worker_wrapper.js b/dom/tests/mochitest/fetch/nested_worker_wrapper.js
--- a/dom/tests/mochitest/fetch/nested_worker_wrapper.js
+++ b/dom/tests/mochitest/fetch/nested_worker_wrapper.js
@@ -1,12 +1,15 @@
+// Hold the nested worker alive until this parent worker closes.
+var worker;
+
 addEventListener('message', function nestedWorkerWrapperOnMessage(evt) {
   removeEventListener('message', nestedWorkerWrapperOnMessage);
 
-  var worker = new Worker('worker_wrapper.js');
+  worker = new Worker('worker_wrapper.js');
 
   worker.addEventListener('message', function(evt) {
     self.postMessage({
       context: 'NestedWorker',
       type: evt.data.type,
       status: evt.data.status,
       msg: evt.data.msg,
     });
